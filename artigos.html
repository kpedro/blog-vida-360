<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todos os Artigos - Vida 360¬∫</title>
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="assets/images/favicon.svg">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Todos os Artigos - Vida 360¬∫">
    <meta property="og:description" content="Explore todos os artigos sobre sa√∫de, bem-estar, produtividade, mentalidade e equil√≠brio.">
    <meta property="og:image" content="https://blog-vida-360.vercel.app/assets/images/og-banner.png">
    <meta property="og:url" content="https://blog-vida-360.vercel.app/artigos.html">
    <meta property="og:type" content="website">
    
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        /* Usa a mesma paleta da p√°gina inicial (vari√°veis em style.css) */
        .page-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .page-header h1 {
            color: var(--blue-primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .page-header p {
            color: var(--blue-dark);
            font-size: 1.1rem;
        }

        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid var(--blue-secondary);
            background: white;
            color: var(--blue-secondary);
            border-radius: 20px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .filter-btn:hover,
        .filter-btn.active {
            background: var(--blue-secondary);
            color: white;
        }

        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .post {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .post:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.15);
        }

        .post-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .post-content {
            padding: 20px;
        }

        .post h3 {
            color: var(--blue-primary);
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.2rem;
        }

        .post p {
            color: var(--blue-dark);
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .post-meta {
            font-size: 0.85rem;
            color: var(--gray-600);
            margin-bottom: 15px;
        }

        .read-more {
            display: inline-block;
            padding: 10px 18px;
            background-color: var(--blue-secondary);
            color: var(--text-color);
            text-decoration: none;
            font-weight: 600;
            border-radius: var(--radius);
            transition: background-color 0.3s;
        }

        .read-more:hover {
            background-color: var(--primary-light);
            color: var(--text-color);
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            padding: 10px 20px;
            border: 2px solid var(--blue-secondary);
            background: white;
            color: var(--blue-secondary);
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .pagination-btn:hover:not(.disabled) {
            background: var(--blue-secondary);
            color: white;
        }

        .pagination-btn.disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background: var(--blue-secondary);
            color: white;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: var(--blue-primary);
            font-size: 1.2rem;
        }

        .no-posts {
            text-align: center;
            padding: 60px 20px;
            color: var(--blue-dark);
        }

        .no-posts h3 {
            color: var(--blue-primary);
            margin-bottom: 10px;
        }

        footer {
            background-color: var(--blue-dark);
            color: var(--text-color);
            text-align: center;
            padding: 15px 0;
            margin-top: 50px;
        }
    </style>
</head>
<body>
    <!-- Cabe√ßalho -->
    <header>
        <div class="container">
            <div class="logo">Vida 360¬∫</div>
            <nav>
                <ul>
                    <li><a href="index.html">In√≠cio</a></li>
                    <li><a href="artigos.html">Artigos</a></li>
                    <li><a href="protocolos.html">Protocolos</a></li>
                    <li><a href="ebooks.html">Ebooks</a></li>
                    <li><a href="quiz.html">Quiz</a></li>
                    <li><a href="sobre.html">Sobre</a></li>
                    <li><a href="contato.html">Contato</a></li>
                    <li><a href="politica.html">Pol√≠tica</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Conte√∫do Principal -->
    <main class="container">
        <div class="page-header">
            <h1>üìö Todos os Artigos</h1>
            <p>Explore nosso conte√∫do completo sobre sa√∫de, bem-estar, produtividade e muito mais</p>
        </div>

        <!-- Filtros por Categoria -->
        <div class="filters" id="filters">
            <button class="filter-btn active" data-categoria="">Todos</button>
            <button class="filter-btn" data-categoria="saude">Sa√∫de</button>
            <button class="filter-btn" data-categoria="bem-estar">Bem-estar</button>
            <button class="filter-btn" data-categoria="produtividade">Produtividade</button>
            <button class="filter-btn" data-categoria="mentalidade">Mentalidade</button>
            <button class="filter-btn" data-categoria="equilibrio">Equil√≠brio</button>
        </div>

        <!-- Grid de Posts -->
        <div id="posts-container">
            <div class="loading">Carregando artigos...</div>
        </div>

        <!-- Pagina√ß√£o -->
        <div class="pagination" id="pagination" style="display: none;"></div>
    </main>

    <!-- Bot√£o flutuante WhatsApp -->
    <a href="https://wa.me/5592994314016?text=Ol%C3%A1!%20Gostaria%20de%20solicitar%20o%20protocolo%20de%20rotinas%20de%20sa%C3%BAde." class="whatsapp-float" target="_blank" rel="noopener noreferrer" aria-label="Fale conosco no WhatsApp para solicitar protocolo de rotinas de sa√∫de">
        <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"/></svg>
    </a>

    <!-- Rodap√© -->
    <footer>
        <p>¬© 2025 Vida 360¬∫. Todos os direitos reservados.</p>
        <p style="margin-top: 10px; font-size: 0.9rem;">
            <a href="feed.xml" style="color: var(--blue-light); text-decoration: none;">üì° RSS Feed</a> | 
            <a href="sitemap.xml" style="color: var(--blue-light); text-decoration: none;">üó∫Ô∏è Sitemap</a> |
            <a href="admin-login.html" style="color: var(--blue-light); text-decoration: none; font-weight: 600;">üîê Painel Admin</a>
        </p>
        <p style="margin-top: 8px; font-size: 0.8rem; opacity: 0.9;">Alguns artigos podem conter links de indica√ß√£o. Ao utiliz√°-los, voc√™ apoia o blog sem custo adicional.</p>
    </footer>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        window.VITE_SUPABASE_URL = window.VITE_SUPABASE_URL || 'https://qrjmvqedoypxmnvfdetg.supabase.co';
        window.VITE_SUPABASE_ANON_KEY = window.VITE_SUPABASE_ANON_KEY || 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InFyam12cWVkb3lweG1udmZkZXRnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM2NDc3MjYsImV4cCI6MjA3OTIyMzcyNn0.QjhD8GQsNiNX58EvVUJvf9seNYGR6ruLvpF1lHpSX8E';
    </script>
    <script src="assets/js/supabase.js"></script>
    <script>
        (function() {
            var postsPerPage = 12;
            var currentPage = 1;
            var currentCategoria = '';
            var allPosts = [];
            var filteredPosts = [];

            async function init() {
                console.log('üîç Inicializando p√°gina de artigos...');
                
                // Inicializar Supabase client se ainda n√£o foi inicializado
                if (typeof initSupabase === 'function' && !window.supabaseClient) {
                    console.log('üì¶ Inicializando Supabase client...');
                    window.supabaseClient = initSupabase();
                }
                
                // Aguardar Supabase client estar pronto
                var client = window.supabaseClient;
                var attempts = 0;
                var maxAttempts = 15;
                
                while ((!client || !client.getPosts) && attempts < maxAttempts) {
                    console.log('‚è≥ Aguardando Supabase client... (tentativa ' + (attempts + 1) + '/' + maxAttempts + ')');
                    await new Promise(resolve => setTimeout(resolve, 300));
                    
                    // Tentar inicializar novamente se ainda n√£o estiver dispon√≠vel
                    if (!window.supabaseClient && typeof initSupabase === 'function') {
                        window.supabaseClient = initSupabase();
                    }
                    
                    client = window.supabaseClient;
                    attempts++;
                }

                if (!client) {
                    console.error('‚ùå Supabase client n√£o dispon√≠vel ap√≥s ' + maxAttempts + ' tentativas');
                    document.getElementById('posts-container').innerHTML = 
                        '<div class="no-posts"><h3>Erro ao carregar artigos</h3><p>N√£o foi poss√≠vel conectar ao banco de dados. Por favor, recarregue a p√°gina.</p></div>';
                    return;
                }

                if (!client.getPosts) {
                    console.error('‚ùå M√©todo getPosts n√£o encontrado no client');
                    console.log('   Client dispon√≠vel:', !!client);
                    console.log('   M√©todos dispon√≠veis:', Object.keys(client));
                    document.getElementById('posts-container').innerHTML = 
                        '<div class="no-posts"><h3>Erro ao carregar artigos</h3><p>Erro na configura√ß√£o do cliente. Por favor, recarregue a p√°gina.</p></div>';
                    return;
                }
                
                console.log('‚úÖ Cliente Supabase pronto!');

                // Carregar todos os posts
                console.log('üì∞ Buscando posts do Supabase...');
                var result = await client.getPosts(200, 0);
                
                console.log('üìä Resultado da busca:', {
                    success: result.success,
                    dataLength: result.data ? result.data.length : 0,
                    error: result.error
                });
                
                if (result.success && result.data && result.data.length > 0) {
                    allPosts = result.data;
                    filteredPosts = allPosts;
                    console.log('‚úÖ ' + allPosts.length + ' artigos carregados com sucesso!');
                    renderPosts();
                    setupFilters();
                } else if (result.success && result.data && result.data.length === 0) {
                    console.warn('‚ö†Ô∏è Nenhum artigo encontrado');
                    document.getElementById('posts-container').innerHTML = 
                        '<div class="no-posts"><h3>Nenhum artigo encontrado</h3><p>Ainda n√£o h√° artigos publicados.</p></div>';
                } else {
                    console.error('‚ùå Erro ao buscar posts:', result.error);
                    document.getElementById('posts-container').innerHTML = 
                        '<div class="no-posts"><h3>Erro ao carregar artigos</h3><p>' + (result.error || 'Erro desconhecido') + '</p><p>Por favor, recarregue a p√°gina.</p></div>';
                }
            }

            function setupFilters() {
                var filterBtns = document.querySelectorAll('.filter-btn');
                filterBtns.forEach(function(btn) {
                    btn.addEventListener('click', function() {
                        filterBtns.forEach(function(b) { b.classList.remove('active'); });
                        this.classList.add('active');
                        currentCategoria = this.getAttribute('data-categoria');
                        currentPage = 1;
                        filterPosts();
                    });
                });
            }

            function filterPosts() {
                if (currentCategoria === '') {
                    filteredPosts = allPosts;
                } else {
                    filteredPosts = allPosts.filter(function(post) {
                        var categoria = (post.categoria || '').toLowerCase();
                        return categoria === currentCategoria.toLowerCase();
                    });
                }
                renderPosts();
            }

            function renderPosts() {
                var container = document.getElementById('posts-container');
                var start = (currentPage - 1) * postsPerPage;
                var end = start + postsPerPage;
                var postsToShow = filteredPosts.slice(start, end);

                if (postsToShow.length === 0) {
                    container.innerHTML = '<div class="no-posts"><h3>Nenhum artigo encontrado</h3><p>Tente selecionar outra categoria.</p></div>';
                    document.getElementById('pagination').style.display = 'none';
                    return;
                }

                var baseUrl = window.location.origin + window.location.pathname.replace(/\/[^/]*$/, '');
                var html = '<div class="posts-grid">';
                
                postsToShow.forEach(function(p) {
                    var titulo = (p.titulo || p.title || 'Artigo').trim();
                    var resumo = (p.resumo || p.excerpt || '').trim();
                    var img = p.imagem_destaque || p.image_url || 'assets/images/equilibrio-vida.jpg';
                    var slug = p.slug || '';
                    var categoria = p.categoria || '';
                    var publishedAt = p.published_at || p.created_at || '';
                    var url = baseUrl + '/post.html?post=' + encodeURIComponent(slug);

                    // Converter URL relativa para absoluta se necess√°rio
                    if (img && !img.startsWith('http://') && !img.startsWith('https://')) {
                        if (!img.startsWith('/')) {
                            img = baseUrl + '/' + img;
                        } else {
                            img = window.location.origin + img;
                        }
                    }

                    var dateStr = '';
                    if (publishedAt) {
                        try {
                            var date = new Date(publishedAt);
                            dateStr = date.toLocaleDateString('pt-BR', { day: 'numeric', month: 'long', year: 'numeric' });
                        } catch (e) {}
                    }

                    html += '<article class="post">';
                    html += '<img src="' + img + '" alt="' + titulo.replace(/"/g, '&quot;') + '" class="post-image" loading="lazy" onerror="this.src=\'assets/images/equilibrio-vida.jpg\'">';
                    html += '<div class="post-content">';
                    if (categoria) {
                        html += '<div class="post-meta">üìÅ ' + categoria + (dateStr ? ' ‚Ä¢ ' + dateStr : '') + '</div>';
                    } else if (dateStr) {
                        html += '<div class="post-meta">üìÖ ' + dateStr + '</div>';
                    }
                    html += '<h3>' + titulo.replace(/</g, '&lt;').replace(/>/g, '&gt;') + '</h3>';
                    html += '<p>' + (resumo || '').replace(/</g, '&lt;').replace(/>/g, '&gt;') + '</p>';
                    html += '<a href="' + url + '" class="read-more">Leia mais ‚Üí</a>';
                    html += '</div>';
                    html += '</article>';
                });

                html += '</div>';
                container.innerHTML = html;

                // Renderizar pagina√ß√£o
                renderPagination();
            }

            function renderPagination() {
                var totalPages = Math.ceil(filteredPosts.length / postsPerPage);
                var pagination = document.getElementById('pagination');

                if (totalPages <= 1) {
                    pagination.style.display = 'none';
                    return;
                }

                pagination.style.display = 'flex';
                var html = '';

                // Bot√£o Anterior
                if (currentPage > 1) {
                    html += '<button class="pagination-btn" onclick="goToPage(' + (currentPage - 1) + ')">‚Üê Anterior</button>';
                } else {
                    html += '<button class="pagination-btn disabled">‚Üê Anterior</button>';
                }

                // N√∫meros das p√°ginas
                var startPage = Math.max(1, currentPage - 2);
                var endPage = Math.min(totalPages, currentPage + 2);

                if (startPage > 1) {
                    html += '<button class="pagination-btn" onclick="goToPage(1)">1</button>';
                    if (startPage > 2) {
                        html += '<span style="padding: 10px;">...</span>';
                    }
                }

                for (var i = startPage; i <= endPage; i++) {
                    if (i === currentPage) {
                        html += '<button class="pagination-btn active">' + i + '</button>';
                    } else {
                        html += '<button class="pagination-btn" onclick="goToPage(' + i + ')">' + i + '</button>';
                    }
                }

                if (endPage < totalPages) {
                    if (endPage < totalPages - 1) {
                        html += '<span style="padding: 10px;">...</span>';
                    }
                    html += '<button class="pagination-btn" onclick="goToPage(' + totalPages + ')">' + totalPages + '</button>';
                }

                // Bot√£o Pr√≥ximo
                if (currentPage < totalPages) {
                    html += '<button class="pagination-btn" onclick="goToPage(' + (currentPage + 1) + ')">Pr√≥ximo ‚Üí</button>';
                } else {
                    html += '<button class="pagination-btn disabled">Pr√≥ximo ‚Üí</button>';
                }

                pagination.innerHTML = html;
            }

            window.goToPage = function(page) {
                currentPage = page;
                renderPosts();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            };

            document.addEventListener('DOMContentLoaded', init);
        })();
    </script>
    <script src="assets/js/chat-widget.js"></script>
</body>
</html>
